"use strict";(self.webpackChunkblogweb_react=self.webpackChunkblogweb_react||[]).push([[831],{831(e,a,l){l.r(a),l.d(a,{default:()=>d});var t=l(555),s=l(43),r=l(997),i=l(305),n=l(227),o=l(579);const d=function(){const e=(0,r.Zp)(),[a,l]=(0,s.useState)([]),[d,c]=(0,s.useState)([]),[m,u]=(0,s.useState)(null),[g,p]=(0,s.useState)(!0),[h,x]=(0,s.useState)(!1),[f,b]=(0,s.useState)({image:!1,featured:!1}),[y,j]=(0,s.useState)(null),[_,v]=(0,s.useState)(null),[N,w]=(0,s.useState)(""),[C,k]=(0,s.useState)({title:"",slug:"",content:"",excerpt:"",category_id:"",image_url:"",featured_image:"",is_featured:!1,is_published:!1,meta_title:"",meta_description:"",meta_keywords:""}),[S,F]=(0,s.useState)({image:null,featured:null});(0,s.useEffect)(()=>{document.title="Admin Panel - Blog Management";const e=localStorage.getItem("admin_username");e&&w(e),A(),E()},[]);const A=async()=>{try{p(!0);const e=await i.Er.blogs.getAll();e.success&&l(e.data||[])}catch(e){console.error("Error fetching blogs:",e),j(e.message||"Failed to load blogs")}finally{p(!1)}},E=async()=>{try{const e=await i.X4.getAll();e.success&&c(e.data||[])}catch(e){console.error("Error fetching categories:",e)}},B=e=>{const{name:a,value:l,type:s,checked:r}=e.target;k((0,t.A)((0,t.A)({},C),{},{[a]:"checkbox"===s?r:l})),"title"!==a||m||k(e=>{return(0,t.A)((0,t.A)({},e),{},{slug:(a=l,a.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""))});var a}),y&&j(null),_&&v(null)},R=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image";const l=e.target.files[0];if(l)if(l.type.match("image.*"))if(l.size>5242880)j("Image size must be less than 5MB");else try{b(e=>(0,t.A)((0,t.A)({},e),{},{[a]:!0})),j(null);const e=new FileReader;e.onloadend=()=>{F(l=>(0,t.A)((0,t.A)({},l),{},{[a]:e.result}))},e.readAsDataURL(l);const s=await i.Er.upload.image(l);if(s.success&&s.data&&s.data.url){const e="image"===a?"image_url":"featured_image";k(a=>(0,t.A)((0,t.A)({},a),{},{[e]:s.data.url})),v("".concat("image"===a?"Image":"Featured image"," uploaded successfully!")),setTimeout(()=>v(null),3e3)}else F(e=>(0,t.A)((0,t.A)({},e),{},{[a]:null})),j(s.message||"Failed to upload image. Please try again or enter a URL manually.")}catch(s){console.error("Error uploading image:",s),F(e=>(0,t.A)((0,t.A)({},e),{},{[a]:null})),j(s.message||"Failed to upload image. Please try again or enter a URL manually.")}finally{b(e=>(0,t.A)((0,t.A)({},e),{},{[a]:!1}))}else j("Please select an image file")},I=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/backend/")){return n.J.replace("/backend/api","")+e}if(e.startsWith("/")){return n.J.replace("/api","")+e}if(e.includes("uploads/")){return n.J.replace("/api","")+"/"+e}return e},P=()=>{u(null),k({title:"",slug:"",content:"",excerpt:"",category_id:"",image_url:"",featured_image:"",is_featured:!1,is_published:!1,meta_title:"",meta_description:"",meta_keywords:""}),F({image:null,featured:null})};return(0,o.jsxs)("div",{className:"admin-container",children:[(0,o.jsxs)("div",{className:"admin-header",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"admin-title",children:"Blog Management Panel"}),(0,o.jsx)("p",{className:"admin-subtitle",children:"Create, edit, and manage your blog posts"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[N&&(0,o.jsxs)("span",{style:{color:"#666",fontSize:"0.9rem"},children:["Welcome, ",(0,o.jsx)("strong",{children:N})]}),(0,o.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to logout?"))try{await i.R2.logout(),e("/vedantlights/login")}catch(a){localStorage.removeItem("admin_authenticated"),localStorage.removeItem("admin_username"),e("/vedantlights/login")}},style:{padding:"0.5rem 1rem",background:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"Logout"})]})]}),(0,o.jsxs)("div",{className:"admin-content",children:[(0,o.jsx)("section",{className:"admin-form-section",children:(0,o.jsxs)("div",{className:"admin-form-panel",children:[(0,o.jsx)("h2",{className:"admin-form-title",children:m?"Edit Blog Post":"Create New Blog Post"}),_&&(0,o.jsx)("div",{style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"#d4edda",color:"#155724",borderRadius:"4px"},children:_}),y&&(0,o.jsx)("div",{style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px"},children:y}),(0,o.jsxs)("form",{className:"admin-form",onSubmit:async e=>{e.preventDefault(),x(!0),j(null),v(null);try{let e;e=m?await i.Er.blogs.update(m.id,C):await i.Er.blogs.create(C),e.success?(v(m?"Blog updated successfully!":"Blog created successfully!"),P(),A(),setTimeout(()=>v(null),3e3)):j(e.message||"Operation failed")}catch(a){console.error("Error saving blog:",a),j(a.message||"Failed to save blog")}finally{x(!1)}},children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"title",className:"form-label",children:"Title *"}),(0,o.jsx)("input",{type:"text",id:"title",name:"title",value:C.title,onChange:B,className:"form-input",placeholder:"Enter blog title",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"slug",className:"form-label",children:"Slug *"}),(0,o.jsx)("input",{type:"text",id:"slug",name:"slug",value:C.slug,onChange:B,className:"form-input",placeholder:"blog-slug-url",required:!0}),(0,o.jsx)("small",{style:{color:"#666",fontSize:"0.875rem"},children:"URL-friendly version of title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"content",className:"form-label",children:"Content *"}),(0,o.jsx)("textarea",{id:"content",name:"content",value:C.content,onChange:B,className:"form-textarea",placeholder:"Enter blog content",rows:"8",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"excerpt",className:"form-label",children:"Excerpt"}),(0,o.jsx)("textarea",{id:"excerpt",name:"excerpt",value:C.excerpt,onChange:B,className:"form-textarea",placeholder:"Short description (used in listings)",rows:"3"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_id",className:"form-label",children:"Category"}),(0,o.jsxs)("select",{id:"category_id",name:"category_id",value:C.category_id,onChange:B,className:"form-select",children:[(0,o.jsx)("option",{value:"",children:"Select Category"}),d.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"image_upload",className:"form-label",children:"Blog Image"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"file",id:"image_upload",accept:"image/*",onChange:e=>R(e,"image"),disabled:f.image,style:{marginBottom:"0.5rem"}}),f.image&&(0,o.jsx)("small",{children:"Uploading..."}),(()=>{const e=S.image||(C.image_url?I(C.image_url):null);return e&&(0,o.jsx)("div",{style:{marginTop:"0.5rem"},children:(0,o.jsx)("img",{src:e,alt:"Preview",style:{maxWidth:"300px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"},onError:e=>{console.error("Image failed to load:",e.target.src),e.target.style.display="none"}})})})(),(0,o.jsx)("input",{type:"text",id:"image_url",name:"image_url",value:C.image_url,onChange:B,className:"form-input",placeholder:"Or enter image URL (optional)",style:{marginTop:"0.5rem"}})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"featured_image_upload",className:"form-label",children:"Featured Image"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"file",id:"featured_image_upload",accept:"image/*",onChange:e=>R(e,"featured"),disabled:f.featured,style:{marginBottom:"0.5rem"}}),f.featured&&(0,o.jsx)("small",{children:"Uploading..."}),(()=>{const e=S.featured||(C.featured_image?I(C.featured_image):null);return e&&(0,o.jsx)("div",{style:{marginTop:"0.5rem"},children:(0,o.jsx)("img",{src:e,alt:"Preview",style:{maxWidth:"300px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"},onError:e=>{console.error("Featured image failed to load:",e.target.src),e.target.style.display="none"}})})})(),(0,o.jsx)("input",{type:"text",id:"featured_image",name:"featured_image",value:C.featured_image,onChange:B,className:"form-input",placeholder:"Or enter featured image URL (optional)",style:{marginTop:"0.5rem"}})]})]}),(0,o.jsxs)("div",{className:"form-group",style:{display:"flex",gap:"2rem",alignItems:"center"},children:[(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",name:"is_featured",checked:C.is_featured,onChange:B}),"Featured"]}),(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",name:"is_published",checked:C.is_published,onChange:B}),"Published"]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_title",className:"form-label",children:"SEO Title"}),(0,o.jsx)("input",{type:"text",id:"meta_title",name:"meta_title",value:C.meta_title,onChange:B,className:"form-input",placeholder:"SEO meta title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_description",className:"form-label",children:"SEO Description"}),(0,o.jsx)("textarea",{id:"meta_description",name:"meta_description",value:C.meta_description,onChange:B,className:"form-textarea",placeholder:"SEO meta description",rows:"2"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_keywords",className:"form-label",children:"SEO Keywords"}),(0,o.jsx)("input",{type:"text",id:"meta_keywords",name:"meta_keywords",value:C.meta_keywords,onChange:B,className:"form-input",placeholder:"keyword1, keyword2, keyword3"})]}),(0,o.jsxs)("div",{className:"form-actions",children:[(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:h,children:h?"Saving...":m?"Update Blog":"Create Blog"}),m&&(0,o.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:P,disabled:h,children:"Cancel"})]})]})]})}),(0,o.jsxs)("section",{className:"admin-list-section",children:[(0,o.jsx)("div",{className:"admin-list-header",children:(0,o.jsxs)("h2",{className:"admin-list-title",children:["All Blog Posts (",a.length,")"]})}),g?(0,o.jsx)("div",{className:"empty-state",children:(0,o.jsx)("p",{children:"Loading blogs..."})}):0===a.length?(0,o.jsx)("div",{className:"empty-state",children:(0,o.jsx)("p",{children:"No blogs found. Create your first blog post!"})}):(0,o.jsx)("div",{className:"admin-blog-list",children:a.map(e=>{var a;return(0,o.jsxs)("div",{className:"admin-blog-card",children:[(0,o.jsx)("div",{className:"admin-blog-image",children:(0,o.jsx)("img",{src:e.image_url||"https://via.placeholder.com/300x200",alt:e.title})}),(0,o.jsxs)("div",{className:"admin-blog-content",children:[(0,o.jsxs)("div",{className:"admin-blog-header",children:[(0,o.jsx)("span",{className:"admin-blog-category",children:e.category_name||"Uncategorized"}),(0,o.jsxs)("span",{className:"admin-blog-date",children:[new Date(e.created_at).toLocaleDateString(),e.is_published?" \u2022 Published":" \u2022 Draft",e.is_featured&&" \u2022 Featured"]})]}),(0,o.jsx)("h3",{className:"admin-blog-title",children:e.title}),(0,o.jsxs)("p",{className:"admin-blog-excerpt",children:[e.excerpt||(null===(a=e.content)||void 0===a?void 0:a.substring(0,150)),"..."]}),(0,o.jsxs)("div",{className:"admin-blog-actions",children:[(0,o.jsx)("button",{className:"btn btn-edit",onClick:()=>(e=>{u(e),k({title:e.title||"",slug:e.slug||"",content:e.content||"",excerpt:e.excerpt||"",category_id:e.category_id||"",image_url:e.image_url||"",featured_image:e.featured_image||"",is_featured:e.is_featured||!1,is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:e.meta_keywords||""});const a=e.image_url?I(e.image_url):null,l=e.featured_image?I(e.featured_image):null;F({image:a,featured:l}),window.scrollTo({top:0,behavior:"smooth"})})(e),children:"Edit"}),(0,o.jsx)("button",{className:"btn btn-delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this blog?"))try{const a=await i.Er.blogs.delete(e);a.success?(v("Blog deleted successfully!"),m&&m.id===e&&P(),A(),setTimeout(()=>v(null),3e3)):j(a.message||"Failed to delete blog")}catch(a){console.error("Error deleting blog:",a),j(a.message||"Failed to delete blog")}})(e.id),children:"Delete"})]})]})]},e.id)})})]})]})]})}}}]);
//# sourceMappingURL=831.bc05eff7.chunk.js.map