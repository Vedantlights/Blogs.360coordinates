"use strict";(self.webpackChunkblogweb_react=self.webpackChunkblogweb_react||[]).push([[831],{831(e,a,l){l.r(a),l.d(a,{default:()=>c});var s=l(555),t=l(43),i=l(997),r=l(305),n=l(227),o=l(579);const c=function(){const e=(0,i.Zp)(),[a,l]=(0,t.useState)([]),[c,d]=(0,t.useState)([]),[m,u]=(0,t.useState)(null),[g,p]=(0,t.useState)(null),[h,x]=(0,t.useState)(!0),[y,f]=(0,t.useState)(!1),[b,j]=(0,t.useState)(!1),[_,v]=(0,t.useState)({image:!1,featured:!1}),[N,C]=(0,t.useState)(null),[w,k]=(0,t.useState)(null),[S,E]=(0,t.useState)(""),[F,A]=(0,t.useState)({name:"",slug:"",icon:"",description:"",display_order:0,is_active:!0}),[B,I]=(0,t.useState)({title:"",slug:"",content:"",excerpt:"",category_id:"",image_url:"",featured_image:"",is_featured:!1,is_published:!1,meta_title:"",meta_description:"",meta_keywords:""}),[R,D]=(0,t.useState)({image:null,featured:null});(0,t.useEffect)(()=>{document.title="Admin Panel - Blog Management";const e=localStorage.getItem("admin_username");e&&E(e),T(),L()},[]);const T=async()=>{try{x(!0);const e=await r.Er.blogs.getAll();e.success&&l(e.data||[])}catch(e){console.error("Error fetching blogs:",e),C(e.message||"Failed to load blogs")}finally{x(!1)}},L=async()=>{try{const e=await r.Er.categories.getAll();e.success&&d(e.data||[])}catch(e){console.error("Error fetching categories:",e)}},P=e=>e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,""),U=e=>{const{name:a,value:l,type:t,checked:i}=e.target;I((0,s.A)((0,s.A)({},B),{},{[a]:"checkbox"===t?i:l})),"title"!==a||m||I(e=>(0,s.A)((0,s.A)({},e),{},{slug:P(l)})),N&&C(null),w&&k(null)},O=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"image";const l=e.target.files[0];if(l)if(l.type.match("image.*"))if(l.size>5242880)C("Image size must be less than 5MB");else try{v(e=>(0,s.A)((0,s.A)({},e),{},{[a]:!0})),C(null);const e=new FileReader;e.onloadend=()=>{D(l=>(0,s.A)((0,s.A)({},l),{},{[a]:e.result}))},e.readAsDataURL(l);const t=await r.Er.upload.image(l);if(t.success&&t.data&&t.data.url){const e="image"===a?"image_url":"featured_image";I(a=>(0,s.A)((0,s.A)({},a),{},{[e]:t.data.url})),k("".concat("image"===a?"Image":"Featured image"," uploaded successfully!")),setTimeout(()=>k(null),3e3)}else D(e=>(0,s.A)((0,s.A)({},e),{},{[a]:null})),C(t.message||"Failed to upload image. Please try again or enter a URL manually.")}catch(t){console.error("Error uploading image:",t),D(e=>(0,s.A)((0,s.A)({},e),{},{[a]:null})),C(t.message||"Failed to upload image. Please try again or enter a URL manually.")}finally{v(e=>(0,s.A)((0,s.A)({},e),{},{[a]:!1}))}else C("Please select an image file")},z=e=>{if(!e)return null;if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("/backend/")){return n.J.replace("/backend/api","")+e}if(e.startsWith("/")){return n.J.replace("/api","")+e}if(e.includes("uploads/")){return n.J.replace("/api","")+"/"+e}return e},W=()=>{u(null),I({title:"",slug:"",content:"",excerpt:"",category_id:"",image_url:"",featured_image:"",is_featured:!1,is_published:!1,meta_title:"",meta_description:"",meta_keywords:""}),D({image:null,featured:null})},q=e=>{const{name:a,value:l,type:t,checked:i}=e.target;A((0,s.A)((0,s.A)({},F),{},{[a]:"checkbox"===t?i:l})),"name"!==a||g||A(e=>(0,s.A)((0,s.A)({},e),{},{slug:P(l)})),N&&C(null),w&&k(null)},J=()=>{p(null),A({name:"",slug:"",icon:"",description:"",display_order:0,is_active:!0})};return(0,o.jsxs)("div",{className:"admin-container",children:[(0,o.jsxs)("div",{className:"admin-header",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"admin-title",children:"Blog Management Panel"}),(0,o.jsx)("p",{className:"admin-subtitle",children:"Create, edit, and manage your blog posts"})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[S&&(0,o.jsxs)("span",{style:{color:"#666",fontSize:"0.9rem"},children:["Welcome, ",(0,o.jsx)("strong",{children:S})]}),(0,o.jsx)("button",{onClick:async()=>{if(window.confirm("Are you sure you want to logout?"))try{await r.R2.logout(),e("/vedantlights/login")}catch(a){localStorage.removeItem("admin_authenticated"),localStorage.removeItem("admin_username"),e("/vedantlights/login")}},style:{padding:"0.5rem 1rem",background:"#dc3545",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"0.9rem"},children:"Logout"})]})]}),(0,o.jsxs)("div",{className:"admin-content",children:[(0,o.jsx)("section",{className:"admin-form-section",children:(0,o.jsxs)("div",{className:"admin-form-panel",children:[(0,o.jsx)("h2",{className:"admin-form-title",children:m?"Edit Blog Post":"Create New Blog Post"}),w&&(0,o.jsx)("div",{style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"#d4edda",color:"#155724",borderRadius:"4px"},children:w}),N&&(0,o.jsx)("div",{style:{padding:"0.75rem",marginBottom:"1rem",backgroundColor:"#f8d7da",color:"#721c24",borderRadius:"4px"},children:N}),(0,o.jsxs)("form",{className:"admin-form",onSubmit:async e=>{e.preventDefault(),f(!0),C(null),k(null);try{let e;e=m?await r.Er.blogs.update(m.id,B):await r.Er.blogs.create(B),e.success?(k(m?"Blog updated successfully!":"Blog created successfully!"),W(),T(),setTimeout(()=>k(null),3e3)):C(e.message||"Operation failed")}catch(a){console.error("Error saving blog:",a),C(a.message||"Failed to save blog")}finally{f(!1)}},children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"title",className:"form-label",children:"Title *"}),(0,o.jsx)("input",{type:"text",id:"title",name:"title",value:B.title,onChange:U,className:"form-input",placeholder:"Enter blog title",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"slug",className:"form-label",children:"Slug *"}),(0,o.jsx)("input",{type:"text",id:"slug",name:"slug",value:B.slug,onChange:U,className:"form-input",placeholder:"blog-slug-url",required:!0}),(0,o.jsx)("small",{style:{color:"#666",fontSize:"0.875rem"},children:"URL-friendly version of title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"content",className:"form-label",children:"Content *"}),(0,o.jsx)("textarea",{id:"content",name:"content",value:B.content,onChange:U,className:"form-textarea",placeholder:"Enter blog content",rows:"8",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"excerpt",className:"form-label",children:"Excerpt"}),(0,o.jsx)("textarea",{id:"excerpt",name:"excerpt",value:B.excerpt,onChange:U,className:"form-textarea",placeholder:"Short description (used in listings)",rows:"3"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_id",className:"form-label",children:"Category"}),(0,o.jsxs)("select",{id:"category_id",name:"category_id",value:B.category_id,onChange:U,className:"form-select",children:[(0,o.jsx)("option",{value:"",children:"Select Category"}),c.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"image_upload",className:"form-label",children:"Blog Image"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"file",id:"image_upload",accept:"image/*",onChange:e=>O(e,"image"),disabled:_.image,style:{marginBottom:"0.5rem"}}),_.image&&(0,o.jsx)("small",{children:"Uploading..."}),(()=>{const e=R.image||(B.image_url?z(B.image_url):null);return e&&(0,o.jsx)("div",{style:{marginTop:"0.5rem"},children:(0,o.jsx)("img",{src:e,alt:"Preview",style:{maxWidth:"300px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"},onError:e=>{console.error("Image failed to load:",e.target.src),e.target.style.display="none"}})})})(),(0,o.jsx)("input",{type:"text",id:"image_url",name:"image_url",value:B.image_url,onChange:U,className:"form-input",placeholder:"Or enter image URL (optional)",style:{marginTop:"0.5rem"}})]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"featured_image_upload",className:"form-label",children:"Featured Image"}),(0,o.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"file",id:"featured_image_upload",accept:"image/*",onChange:e=>O(e,"featured"),disabled:_.featured,style:{marginBottom:"0.5rem"}}),_.featured&&(0,o.jsx)("small",{children:"Uploading..."}),(()=>{const e=R.featured||(B.featured_image?z(B.featured_image):null);return e&&(0,o.jsx)("div",{style:{marginTop:"0.5rem"},children:(0,o.jsx)("img",{src:e,alt:"Preview",style:{maxWidth:"300px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px",border:"1px solid #ddd"},onError:e=>{console.error("Featured image failed to load:",e.target.src),e.target.style.display="none"}})})})(),(0,o.jsx)("input",{type:"text",id:"featured_image",name:"featured_image",value:B.featured_image,onChange:U,className:"form-input",placeholder:"Or enter featured image URL (optional)",style:{marginTop:"0.5rem"}})]})]}),(0,o.jsxs)("div",{className:"form-group",style:{display:"flex",gap:"2rem",alignItems:"center"},children:[(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",name:"is_featured",checked:B.is_featured,onChange:U}),"Featured"]}),(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",name:"is_published",checked:B.is_published,onChange:U}),"Published"]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_title",className:"form-label",children:"SEO Title"}),(0,o.jsx)("input",{type:"text",id:"meta_title",name:"meta_title",value:B.meta_title,onChange:U,className:"form-input",placeholder:"SEO meta title"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_description",className:"form-label",children:"SEO Description"}),(0,o.jsx)("textarea",{id:"meta_description",name:"meta_description",value:B.meta_description,onChange:U,className:"form-textarea",placeholder:"SEO meta description",rows:"2"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"meta_keywords",className:"form-label",children:"SEO Keywords"}),(0,o.jsx)("input",{type:"text",id:"meta_keywords",name:"meta_keywords",value:B.meta_keywords,onChange:U,className:"form-input",placeholder:"keyword1, keyword2, keyword3"})]}),(0,o.jsxs)("div",{className:"form-actions",children:[(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:y,children:y?"Saving...":m?"Update Blog":"Create Blog"}),m&&(0,o.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:W,disabled:y,children:"Cancel"})]})]})]})}),(0,o.jsx)("section",{className:"admin-form-section",children:(0,o.jsxs)("div",{className:"admin-form-panel",children:[(0,o.jsx)("h2",{className:"admin-form-title",children:g?"Edit Category":"Create New Category"}),(0,o.jsxs)("form",{className:"admin-form",onSubmit:async e=>{e.preventDefault(),j(!0),C(null),k(null);try{let e;e=g?await r.Er.categories.update(g.id,F):await r.Er.categories.create(F),e.success?(k(g?"Category updated successfully!":"Category created successfully!"),J(),L(),setTimeout(()=>k(null),3e3)):C(e.message||"Operation failed")}catch(a){console.error("Error saving category:",a),C(a.message||"Failed to save category")}finally{j(!1)}},children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_name",className:"form-label",children:"Category Name *"}),(0,o.jsx)("input",{type:"text",id:"category_name",name:"name",value:F.name,onChange:q,className:"form-input",placeholder:"e.g., Sell",required:!0})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_slug",className:"form-label",children:"Slug *"}),(0,o.jsx)("input",{type:"text",id:"category_slug",name:"slug",value:F.slug,onChange:q,className:"form-input",placeholder:"sell",required:!0}),(0,o.jsx)("small",{style:{color:"#666",fontSize:"0.875rem"},children:"URL-friendly version"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_icon",className:"form-label",children:"Icon (Emoji)"}),(0,o.jsx)("input",{type:"text",id:"category_icon",name:"icon",value:F.icon,onChange:q,className:"form-input",placeholder:"\ud83d\udcb0",maxLength:"10"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_description",className:"form-label",children:"Description"}),(0,o.jsx)("textarea",{id:"category_description",name:"description",value:F.description,onChange:q,className:"form-textarea",placeholder:"Complete guides for property sellers",rows:"2"})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{htmlFor:"category_display_order",className:"form-label",children:"Display Order"}),(0,o.jsx)("input",{type:"number",id:"category_display_order",name:"display_order",value:F.display_order,onChange:q,className:"form-input",placeholder:"3",min:"0"})]}),(0,o.jsx)("div",{className:"form-group",children:(0,o.jsxs)("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("input",{type:"checkbox",name:"is_active",checked:F.is_active,onChange:q}),"Active"]})}),(0,o.jsxs)("div",{className:"form-actions",children:[(0,o.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:b,children:b?"Saving...":g?"Update Category":"Create Category"}),g&&(0,o.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:J,disabled:b,children:"Cancel"})]})]})]})}),(0,o.jsxs)("section",{className:"admin-list-section",children:[(0,o.jsx)("div",{className:"admin-list-header",children:(0,o.jsxs)("h2",{className:"admin-list-title",children:["All Categories (",c.length,")"]})}),0===c.length?(0,o.jsx)("div",{className:"empty-state",children:(0,o.jsx)("p",{children:"No categories found. Create your first category!"})}):(0,o.jsx)("div",{className:"admin-blog-list",children:c.map(e=>(0,o.jsx)("div",{className:"admin-blog-card",children:(0,o.jsxs)("div",{className:"admin-blog-content",children:[(0,o.jsxs)("div",{className:"admin-blog-header",children:[(0,o.jsxs)("span",{className:"admin-blog-category",children:[e.icon&&(0,o.jsx)("span",{style:{marginRight:"0.5rem"},children:e.icon}),e.name]}),(0,o.jsxs)("span",{className:"admin-blog-date",children:["Order: ",e.display_order," \u2022 ",e.is_active?"Active":"Inactive"]})]}),(0,o.jsxs)("h3",{className:"admin-blog-title",children:["Slug: ",e.slug]}),e.description&&(0,o.jsx)("p",{className:"admin-blog-excerpt",children:e.description}),(0,o.jsxs)("div",{className:"admin-blog-actions",children:[(0,o.jsx)("button",{className:"btn btn-edit",onClick:()=>(e=>{p(e),A({name:e.name||"",slug:e.slug||"",icon:e.icon||"",description:e.description||"",display_order:e.display_order||0,is_active:void 0===e.is_active||e.is_active}),window.scrollTo({top:0,behavior:"smooth"})})(e),children:"Edit"}),(0,o.jsx)("button",{className:"btn btn-delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this category?"))try{const a=await r.Er.categories.delete(e);a.success?(k("Category deleted successfully!"),g&&g.id===e&&J(),L(),setTimeout(()=>k(null),3e3)):C(a.message||"Failed to delete category")}catch(a){console.error("Error deleting category:",a),C(a.message||"Failed to delete category")}})(e.id),children:"Delete"})]})]})},e.id))})]}),(0,o.jsxs)("section",{className:"admin-list-section",children:[(0,o.jsx)("div",{className:"admin-list-header",children:(0,o.jsxs)("h2",{className:"admin-list-title",children:["All Blog Posts (",a.length,")"]})}),h?(0,o.jsx)("div",{className:"empty-state",children:(0,o.jsx)("p",{children:"Loading blogs..."})}):0===a.length?(0,o.jsx)("div",{className:"empty-state",children:(0,o.jsx)("p",{children:"No blogs found. Create your first blog post!"})}):(0,o.jsx)("div",{className:"admin-blog-list",children:a.map(e=>{var a;return(0,o.jsxs)("div",{className:"admin-blog-card",children:[(0,o.jsx)("div",{className:"admin-blog-image",children:(0,o.jsx)("img",{src:e.image_url||"https://via.placeholder.com/300x200",alt:e.title})}),(0,o.jsxs)("div",{className:"admin-blog-content",children:[(0,o.jsxs)("div",{className:"admin-blog-header",children:[(0,o.jsx)("span",{className:"admin-blog-category",children:e.category_name||"Uncategorized"}),(0,o.jsxs)("span",{className:"admin-blog-date",children:[new Date(e.created_at).toLocaleDateString(),e.is_published?" \u2022 Published":" \u2022 Draft",e.is_featured&&" \u2022 Featured"]})]}),(0,o.jsx)("h3",{className:"admin-blog-title",children:e.title}),(0,o.jsxs)("p",{className:"admin-blog-excerpt",children:[e.excerpt||(null===(a=e.content)||void 0===a?void 0:a.substring(0,150)),"..."]}),(0,o.jsxs)("div",{className:"admin-blog-actions",children:[(0,o.jsx)("button",{className:"btn btn-edit",onClick:()=>(e=>{u(e),I({title:e.title||"",slug:e.slug||"",content:e.content||"",excerpt:e.excerpt||"",category_id:e.category_id||"",image_url:e.image_url||"",featured_image:e.featured_image||"",is_featured:e.is_featured||!1,is_published:e.is_published||!1,meta_title:e.meta_title||"",meta_description:e.meta_description||"",meta_keywords:e.meta_keywords||""});const a=e.image_url?z(e.image_url):null,l=e.featured_image?z(e.featured_image):null;D({image:a,featured:l}),window.scrollTo({top:0,behavior:"smooth"})})(e),children:"Edit"}),(0,o.jsx)("button",{className:"btn btn-delete",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this blog?"))try{const a=await r.Er.blogs.delete(e);a.success?(k("Blog deleted successfully!"),m&&m.id===e&&W(),T(),setTimeout(()=>k(null),3e3)):C(a.message||"Failed to delete blog")}catch(a){console.error("Error deleting blog:",a),C(a.message||"Failed to delete blog")}})(e.id),children:"Delete"})]})]})]},e.id)})})]})]})]})}}}]);
//# sourceMappingURL=831.122e7188.chunk.js.map